<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<title>Transfer Tetris Earnings to TIFFY</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
<script src="https://unpkg.com/web3modal@1.9.12/dist/index.js"></script>
<style>
Â  body {
Â  Â  background: radial-gradient(circle at top, #020024, #090979, #000);
Â  Â  color: #0ff;
Â  Â  font-family: 'Orbitron', sans-serif;
Â  Â  text-align: center;
Â  Â  padding: 20px;
Â  }
Â  h1 {
Â  Â  text-shadow: 0 0 20px #00faff, 0 0 40px #00faff;
Â  Â  margin-bottom: 30px;
Â  }
Â  .card {
Â  Â  background: rgba(0, 0, 0, 0.3);
Â  Â  padding: 20px;
Â  Â  border: 1px solid #0ff;
Â  Â  border-radius: 12px;
Â  Â  display: inline-block;
Â  Â  box-shadow: 0 0 20px #0ff, inset 0 0 30px rgba(0,255,255,0.2);
Â  Â  backdrop-filter: blur(10px);
Â  Â  margin-top: 20px;
Â  }
Â  .btn {
Â  Â  margin-top: 20px;
Â  Â  padding: 14px 30px;
Â  Â  font-size: 18px;
Â  Â  border: none;
Â  Â  border-radius: 12px;
Â  Â  cursor: pointer;
Â  Â  font-family: 'Orbitron', sans-serif;
Â  Â  text-transform: uppercase;
Â  Â  letter-spacing: 2px;
Â  Â  transition: all 0.3s ease;
Â  }
Â  /* Connect Button Style */
Â  #connectBtn {
Â  Â  background: rgba(0, 200, 255, 0.15);
Â  Â  border: 1px solid #0ff;
Â  Â  color: #0ff;
Â  Â  box-shadow: 0 0 20px #00faff, 0 0 40px #00faff;
Â  Â  backdrop-filter: blur(8px);
Â  Â  animation: pulseBlue 1.8s infinite;
Â  }
Â  #connectBtn:hover {
Â  Â  background: rgba(0, 200, 255, 0.3);
Â  Â  transform: scale(1.05);
Â  Â  box-shadow: 0 0 30px #00faff, 0 0 60px #00faff;
Â  }
Â  @keyframes pulseBlue {
Â  Â  0% { box-shadow: 0 0 15px #00faff, 0 0 25px #00faff; }
Â  Â  50% { box-shadow: 0 0 35px #00faff, 0 0 60px #00faff; }
Â  Â  100% { box-shadow: 0 0 15px #00faff, 0 0 25px #00faff; }
Â  }
Â  /* Transfer Button Style */
Â  .transfer {
Â  Â  background: rgba(255, 20, 147, 0.2);
Â  Â  border: 1px solid hotpink;
Â  Â  color: hotpink;
Â  Â  box-shadow: 0 0 20px hotpink, 0 0 40px hotpink;
Â  Â  animation: pulsePink 1.5s infinite;
Â  }
Â  .transfer:hover {
Â  Â  background: rgba(255, 20, 147, 0.3);
Â  Â  transform: scale(1.05);
Â  Â  box-shadow: 0 0 30px hotpink, 0 0 60px hotpink;
Â  }
Â  @keyframes pulsePink {
Â  Â  0% { box-shadow: 0 0 15px hotpink, 0 0 25px hotpink; }
Â  Â  50% { box-shadow: 0 0 35px hotpink, 0 0 60px hotpink; }
Â  Â  100% { box-shadow: 0 0 15px hotpink, 0 0 25px hotpink; }
Â  }
</style>
</head>
<body>

<h1>ðŸš€ Transfer Tetris Earnings</h1>

<audio id="clickSound" src="click.wav" preload="auto"></audio>

<button id="connectBtn" class="btn">Connect Wallet</button>

<div class="card" id="transferCard" style="display:none">
Â  <div><strong>Wallet:</strong> <span id="walletAddress"></span></div>
Â  <div><strong>Claimed TIFFY:</strong> <span id="claimed">0</span></div>
Â  <div><strong>Tetris Earnings:</strong> <span id="tetris">0</span></div>
Â  <div style="margin-top:10px;font-size:18px"><strong>Total Withdrawable:</strong> <span id="total">0</span></div>
Â  <button class="btn transfer" id="transferBtn" style="display:none">Transfer Now</button>
</div>

<script>
(async ()=>{
Â  let web3, provider, account;
Â  const clickSound = document.getElementById("clickSound");

Â  const wModal = new Web3Modal.default({
Â  Â  cacheProvider:false,
Â  Â  providerOptions:{
Â  Â  Â  walletconnect:{package:window.WalletConnectProvider?.default||{}, options:{ rpc:{56:"https://bsc-dataseed.binance.org/"}}}
Â  Â  }
Â  });

Â  document.getElementById("connectBtn").onclick = async() => {
Â  Â  clickSound.play();
Â  Â  provider = await wModal.connect();
Â  Â  web3 = new Web3(provider);

Â  Â  const cid = await web3.eth.getChainId();
Â  Â  if(cid !== 56){
Â  Â  Â  try {Â 
Â  Â  Â  Â  await provider.request({ method:"wallet_switchEthereumChain", params:[{chainId:"0x38"}] });
Â  Â  Â  }
Â  Â  Â  catch(e){
Â  Â  Â  Â  if(provider.isBitget || provider.isBitKeep){
Â  Â  Â  Â  Â  try {Â 
Â  Â  Â  Â  Â  Â  await provider.request({ method:"wallet_addEthereumChain", params:[{chainId:"0x38",chainName:"BNB Smart Chain",rpcUrls:["https://bsc-dataseed.binance.org/"],nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18},blockExplorerUrls:["https://bscscan.com"]}]});
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  catch{
Â  Â  Â  Â  Â  Â  alert("ðŸŒ Bitget: please switch BSC manually.");
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  } else {Â 
Â  Â  Â  Â  Â  alert("â— Please switch to BNB Smart Chain");Â 
Â  Â  Â  Â  Â  return;Â 
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  }

Â  Â  const accts = await web3.eth.getAccounts();
Â  Â  account = accts[0];

Â  Â  document.getElementById("walletAddress").textContent = account;
Â  Â  document.getElementById("connectBtn").style.display = "none";
Â  Â  document.getElementById("transferCard").style.display = "inline-block";
Â  Â  loadBalances();
Â  };

Â  // --- START of changes ---

Â  // Use parseFloat to handle decimal values from localStorage
Â  function getClaimed(){
Â  Â  return parseFloat(localStorage.getItem(`tiffyClaimed_${account}`) || "0");
Â  }

Â  function getTetris(){
Â  Â  // Assuming tetrusScore is stored as a decimal in the game script
Â  Â  return parseFloat(localStorage.getItem("tetrusScore") || "0");
Â  }

Â  function loadBalances(){
Â  Â  const claimed = getClaimed();
Â  Â  const tetris = getTetris();
Â  Â  document.getElementById("claimed").textContent = claimed;
Â  Â  document.getElementById("tetris").textContent = tetris;
Â  Â  
Â  Â  // Ensure the addition is a numeric operation
Â  Â  const total = claimed + tetris;
Â  Â  // Display the total with a fixed decimal precision
Â  Â  document.getElementById("total").textContent = total.toFixed(2);
Â  Â  
Â  Â  // Check if tetris earnings are greater than 0 before showing the button
Â  Â  document.getElementById("transferBtn").style.display = tetris > 0 ? "inline-block" : "none";
Â  }

Â  document.getElementById("transferBtn").onclick = () => {
Â  Â  clickSound.play();
Â  Â  const claimedKey = `tiffyClaimed_${account}`;
Â  Â  const claimed = getClaimed();
Â  Â  const tetris = getTetris();
Â  Â  const newTotal = claimed + tetris;

Â  Â  // Store the new total as a string in local storage
Â  Â  localStorage.setItem(claimedKey, newTotal.toString());
Â  Â  // Reset the tetris score to 0
Â  Â  localStorage.setItem("tetrusScore", "0");

Â  Â  loadBalances();
Â  Â  alert(`âœ… Transferred ${tetris.toFixed(2)} Tetris earnings to TIFFY!`);
Â  };

Â  // --- END of changes ---

})();
</script>

</body>
</html>
